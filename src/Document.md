# Document of scripts
This document aims to help users understand the scripts of the ONN4MST model. The scipts of ONN4MST consist of several parts, including data preprocessing, model, training, testing, and searching scripts.

## Data preprocessing
The function of "preprocess.py" is to convert species abundance table files (such as those generated using Qiime software based on 16S rRNA data or metagenomics data) into files in NumPY array format that the model could accept, (npz file). The script will call the phylogenetic tree in NCBI database, map each species in the species abundance table to the phylogenetic tree, and calculate the relative abundance of species on the phylogenetic tree. The "npz" file generated by this script can be used as input file to the training, testing and searching scripts.

## Model
The function of "graph_builder.py" is to encode the Ontology-aware Neural Network. Specifically, in this script, we can know how many layers the ontological neural network has, how many neurons each layer has, and how the different layers are connected. In addition, the script defines some hyperparameters, such as the memory invocation ratio of the GPU.

## Training and testing
The function of "training.py" and "testing.py" is to train and test the Ontology-aware Neural Network. We performed 8-fold cross validation on each dataset when training and testing the model. Specifically, each dataset was randomly divided into eight folds, with seven as training datasets and the remaining one as test datasets. For each experiments, the training process is divided into 10,000 iterations, and each iteration randomly selects 1024 samples, which are provided to the model to calculate the loss function and gradient, and then the gradient is used to update model parameters. Then we assessed the trained model with the test data set. This was repeated for eight times, and the average performance of the model was assessed over the eight experiments.

## Searching
The function of "searching.py" is to search microbial community samples against the general model, and the result will report potential sources of query samples at each biome ontology layer.

